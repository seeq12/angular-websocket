{"version":3,"sources":["dist/angular-websocket.js"],"names":["global","factory","define","amd","exports","module","require","mod","angular","ws","angularWebsocket","this","_angular","$WebSocketProvider","$rootScope","$q","$timeout","$websocketBackend","$WebSocket","url","protocols","options","isObject","isArray","undefined","ssl","test","scope","rootScopeFailover","useApplyAsync","initialTimeout","maxTimeout","reconnectIfNotNormalClose","binaryType","_reconnectAttempts","_reconnectTimer","sendQueue","onOpenCallbacks","onMessageCallbacks","onErrorCallbacks","onCloseCallbacks","objectFreeze","_readyStateConstants","_connect","_setInternalState","prototype","CONNECTING","OPEN","CLOSING","CLOSED","RECONNECT_ABORTED","_normalCloseCode","_reconnectableStatusCodes","safeDigest","autoApply","$$phase","$digest","bindToScope","self","$on","force","socket","onmessage","onopen","onerror","onclose","close","readyState","create","_angular2","default","bind","_onMessageHandler","_onOpenHandler","_onErrorHandler","_onCloseHandler","fireQueue","length","data","shift","send","isString","message","JSON","stringify","deferred","resolve","notifyOpenCallbacks","event","i","call","notifyCloseCallbacks","notifyErrorCallbacks","onOpen","cb","push","onClose","onError","onMessage","callback","isFunction","Error","isDefined","filter","RegExp","fn","pattern","$applyAsync","code","indexOf","reconnect","applyAsyncOrDigest","args","arraySlice","arguments","apply","currentCallback","exec","bufferedAmount","cancel","cancelableify","promise","then","reason","splice","reject","defer","backoffDelay","_getBackoffDelay","backoffDelaySeconds","console","log","attempt","R","Math","random","T","N","M","floor","min","pow","state","objectDefineProperty","_internalConnectionState","forEach","pending","get","set","$WebSocketBackendProvider","$log","Socket","createWebSocketBackend","warn","Object","defineProperty","value","obj","__esModule","window","Client","client","e","WebSocket","MozWebSocket","noop","freeze","Array","slice","elt","len","from","Number","ceil","service"],"mappings":"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"}